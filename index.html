<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Travel Booking - Book Your Dream Destination</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
    }

    .bg-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    .shape {
      position: absolute;
      opacity: 0.1;
      animation: float 20s infinite;
    }

    .shape:nth-child(1) {
      top: 10%;
      left: 10%;
      width: 80px;
      height: 80px;
      background: #3182ce;
      border-radius: 50%;
      animation-delay: 0s;
    }

    .shape:nth-child(2) {
      top: 60%;
      right: 10%;
      width: 120px;
      height: 120px;
      background: #805ad5;
      border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
      animation-delay: 3s;
    }

    .shape:nth-child(3) {
      bottom: 10%;
      left: 20%;
      width: 100px;
      height: 100px;
      background: #38b2ac;
      border-radius: 20px;
      animation-delay: 1.5s;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      33% { transform: translateY(-30px) rotate(120deg); }
      66% { transform: translateY(30px) rotate(240deg); }
    }

    .container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 50px 45px;
      border-radius: 25px;
      box-shadow: 0 25px 80px rgba(0,0,0,0.12);
      max-width: 550px;
      width: 100%;
      position: relative;
      z-index: 1;
      animation: slideUp 0.6s ease-out;
      border: 1px solid rgba(255,255,255,0.8);
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .icon {
      font-size: 50px;
      margin-bottom: 15px;
      display: inline-block;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .header h1 {
      color: #1a202c;
      font-size: 34px;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: -0.5px;
    }

    .header p {
      color: #718096;
      font-size: 15px;
      font-weight: 400;
    }

    .form-group {
      margin-bottom: 25px;
      position: relative;
    }

    label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      color: #2d3748;
      font-size: 14px;
      letter-spacing: 0.3px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .label-icon {
      font-size: 18px;
    }

    input[type="email"],
    input[type="date"],
    input[type="text"],
    input[type="number"],
    select {
      width: 100%;
      padding: 15px 18px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 15px;
      transition: all 0.3s ease;
      background: #fafbfc;
      color: #2d3748;
      font-family: 'Poppins', sans-serif;
    }

    input:focus,
    select:focus {
      outline: none;
      border-color: #3182ce;
      background: white;
      box-shadow: 0 0 0 4px rgba(49,130,206,0.1);
      transform: translateY(-2px);
    }

    input::placeholder {
      color: #a0aec0;
    }

    select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%232d3748' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 15px center;
      padding-right: 40px;
    }

    input[type="range"] {
      width: 100%;
      height: 8px;
      margin-top: 12px;
      border-radius: 10px;
      background: linear-gradient(to right, #3182ce 0%, #3182ce 40%, #e2e8f0 40%, #e2e8f0 100%);
      outline: none;
      -webkit-appearance: none;
      transition: background 0.3s ease;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(49,130,206,0.4);
      border: 3px solid #3182ce;
      transition: all 0.3s ease;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.15);
      box-shadow: 0 4px 12px rgba(49,130,206,0.6);
    }

    input[type="range"]::-moz-range-thumb {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      border: 3px solid #3182ce;
      box-shadow: 0 2px 8px rgba(49,130,206,0.4);
    }

    .range-display {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 13px;
      color: #718096;
    }

    .range-value {
      color: #3182ce;
      font-weight: 700;
      font-size: 16px;
    }

    button {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #3182ce 0%, #2c5aa0 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 20px;
      letter-spacing: 1px;
      text-transform: uppercase;
      font-family: 'Poppins', sans-serif;
      position: relative;
      overflow: hidden;
    }

    button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    button:hover::before {
      width: 300px;
      height: 300px;
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(49,130,206,0.4);
    }

    button:active {
      transform: translateY(-1px);
    }

    button:disabled {
      background: linear-gradient(135deg, #cbd5e0 0%, #a0aec0 100%);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    button span {
      position: relative;
      z-index: 1;
    }

    .loading {
      display: none;
      text-align: center;
      margin-top: 15px;
      color: #3182ce;
      font-weight: 500;
      animation: pulse 1.5s infinite;
    }

    .loading.show {
      display: block;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .success-message {
      display: none;
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      margin-top: 20px;
      animation: slideUp 0.5s ease-out;
      font-weight: 500;
    }

    .success-message.show {
      display: block;
    }

    .error-message {
      display: none;
      background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
      color: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      margin-top: 20px;
      animation: shake 0.5s ease-out;
      font-weight: 500;
    }

    .error-message.show {
      display: block;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      opacity: 1;
    }

    @media (max-width: 600px) {
      .container {
        padding: 35px 25px;
      }
      
      .header h1 {
        font-size: 28px;
      }

      .icon {
        font-size: 40px;
      }
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-left: 10px;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="bg-animation">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
  </div>

  <div class="container">
    <div class="header">
      <div class="icon">‚úàÔ∏è</div>
      <h1>Travel Booking</h1>
      <p>Plan your next adventure with us</p>
    </div>
    
    <form id="bookingForm">
      <div class="form-group">
        <label for="name">
          <span class="label-icon">üë§</span>
          Full Name
        </label>
        <input type="text" id="name" name="full_name" placeholder="Enter your full name" required>
      </div>

      <div class="form-group">
        <label for="email">
          <span class="label-icon">üìß</span>
          Email Address
        </label>
        <input type="email" id="email" name="email" placeholder="your.email@example.com" required>
      </div>

      <div class="form-group">
        <label for="travel-date">
          <span class="label-icon">üìÖ</span>
          Travel Date
        </label>
        <input type="date" id="travel-date" name="travel_date" min="2025-10-16" required>
      </div>

      <div class="form-group">
        <label for="destination">
          <span class="label-icon">üåç</span>
          Destination
        </label>
        <select id="destination" name="destination" required>
          <option value="">Select your dream destination</option>
          <option value="Paris, France">üá´üá∑ Paris, France</option>
          <option value="Tokyo, Japan">üáØüáµ Tokyo, Japan</option>
          <option value="New York, USA">üá∫üá∏ New York, USA</option>
          <option value="Dubai, UAE">üá¶üá™ Dubai, UAE</option>
          <option value="London, UK">üá¨üáß London, UK</option>
          <option value="Singapore">üá∏üá¨ Singapore</option>
          <option value="Maldives">üá≤üáª Maldives</option>
          <option value="Sydney, Australia">üá¶üá∫ Sydney, Australia</option>
          <option value="Rome, Italy">üáÆüáπ Rome, Italy</option>
          <option value="Bali, Indonesia">üáÆüá© Bali, Indonesia</option>
        </select>
      </div>

      <div class="form-group">
        <label for="passengers">
          <span class="label-icon">üë•</span>
          Number of Passengers
        </label>
        <input type="number" id="passengers" name="passengers" min="1" max="10" value="1" required>
      </div>

      <div class="form-group">
        <label for="baggage-weight">
          <span class="label-icon">üß≥</span>
          Baggage Weight
        </label>
        <input type="range" id="baggage-weight" name="baggage_weight" min="0" max="50" value="20" oninput="updateRange(this.value)">
        <div class="range-display">
          <span>0 kg</span>
          <span class="range-value" id="rangeValue">20 kg</span>
          <span>50 kg</span>
        </div>
      </div>

      <button type="submit" id="submitBtn">
        <span id="btnText">Book Now</span>
      </button>
      
      <div class="loading" id="loading">
        Submitting your booking & sending confirmation email...
      </div>
    </form>

    <div class="success-message" id="successMessage"></div>
    <div class="error-message" id="errorMessage"></div>
  </div>

  <!-- Supabase JS Client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- EmailJS SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  
  <script>
    // EmailJS Configuration - YOUR CREDENTIALS
    const EMAILJS_PUBLIC_KEY = 'bwnZ0GBoEhWDhAg6_';
    const EMAILJS_SERVICE_ID = 'service_gmz02ys';
    const EMAILJS_TEMPLATE_ID = 'template_dcgsbdz';

    // Supabase Configuration
    const SUPABASE_URL = 'https://kuxhpfuljzcxojpnvaqy.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1eGhwZnVsanpjeG9qcG52YXF5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1NjAyODEsImV4cCI6MjA3NjEzNjI4MX0.fs23br86-8EbRrIWIpaefhddFuSKQwag_0v4axKY8b0';

    // Initialize EmailJS
    emailjs.init(EMAILJS_PUBLIC_KEY);

    // Initialize Supabase
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Update range slider
    function updateRange(val) {
      document.getElementById('rangeValue').textContent = val + ' kg';
      const percentage = (val / 50) * 100;
      const slider = document.getElementById('baggage-weight');
      slider.style.background = `linear-gradient(to right, #3182ce 0%, #3182ce ${percentage}%, #e2e8f0 ${percentage}%, #e2e8f0 100%)`;
    }

    // Send confirmation email using EmailJS
    async function sendConfirmationEmail(bookingData) {
      try {
        const templateParams = {
          to_email: bookingData.email,
          to_name: bookingData.full_name,
          booking_id: bookingData.id,
          destination: bookingData.destination,
          travel_date: bookingData.travel_date,
          passengers: bookingData.passengers,
          baggage_weight: bookingData.baggage_weight,
          email: bookingData.email // For {{email}} variable in template
        };

        const response = await emailjs.send(
          EMAILJS_SERVICE_ID,
          EMAILJS_TEMPLATE_ID,
          templateParams
        );

        console.log('‚úÖ Email sent successfully!', response);
        return true;
      } catch (error) {
        console.error('‚ùå Email sending failed:', error);
        return false;
      }
    }

    // Form submission handler
    document.getElementById('bookingForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      const btnText = document.getElementById('btnText');
      const loading = document.getElementById('loading');
      const successMessage = document.getElementById('successMessage');
      const errorMessage = document.getElementById('errorMessage');
      
      // Hide previous messages
      successMessage.classList.remove('show');
      errorMessage.classList.remove('show');
      
      // Disable button and show loading
      submitBtn.disabled = true;
      btnText.innerHTML = 'Processing <span class="spinner"></span>';
      loading.classList.add('show');
      
      // Get form data
      const formData = {
        full_name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        travel_date: document.getElementById('travel-date').value,
        destination: document.getElementById('destination').value,
        passengers: parseInt(document.getElementById('passengers').value),
        baggage_weight: parseInt(document.getElementById('baggage-weight').value)
      };

      try {
        // Step 1: Save to Supabase database
        const { data, error } = await supabase
          .from('travel_bookings')
          .insert([formData])
          .select();

        if (error) throw error;

        // Step 2: Send confirmation email to customer
        const emailSent = await sendConfirmationEmail({
          ...formData,
          id: data[0].id
        });

        // Success message
        successMessage.innerHTML = `
          ‚úÖ <strong>Booking Confirmed!</strong><br><br>
          Booking ID: <strong>#${data[0].id}</strong><br>
          Destination: <strong>${formData.destination}</strong><br>
          Travel Date: <strong>${formData.travel_date}</strong><br><br>
          ${emailSent 
            ? 'üìß Confirmation email sent to <strong>' + formData.email + '</strong>' 
            : '‚ö†Ô∏è Booking saved! Email will be sent shortly.'}
        `;
        successMessage.classList.add('show');
        
        // Reset form
        document.getElementById('bookingForm').reset();
        updateRange(20);
        
        setTimeout(() => successMessage.classList.remove('show'), 8000);
        
      } catch (error) {
        console.error('Error:', error);
        errorMessage.innerHTML = `
          ‚ùå <strong>Booking Failed</strong><br><br>
          ${error.message}<br><br>
          Please try again or contact support.
        `;
        errorMessage.classList.add('show');
        setTimeout(() => errorMessage.classList.remove('show'), 7000);
      } finally {
        // Re-enable button
        submitBtn.disabled = false;
        btnText.textContent = 'Book Now';
        loading.classList.remove('show');
      }
    });

    // Initialize range slider
    updateRange(20);
  </script>
</body>
</html>

